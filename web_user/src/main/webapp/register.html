<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta content="IE=9; IE=8; IE=7; IE=EDGE" http-equiv="X-UA-Compatible">
    <meta content="IE=EmulateIE7" http-equiv="X-UA-Compatible"/>
    <title>个人注册</title>
    <link href="img/favicon.ico" rel="icon">
    <link href="css/webbase.css" rel="stylesheet" type="text/css"/>
    <link href="css/pages-register.css" rel="stylesheet" type="text/css"/>
</head>


<body>

<div id="app">
    <div class="register py-container ">
        <div style="height: 90px; padding-top: 10px;">
            <img alt="" height="80" src="img/logo.png" style="float:left; " width="80">
            <div class="manage-title" style="color: dimgrey; font-size: 25px; margin-top: 30px;">用户注册</div>
        </div>

        <div class="registerArea">
            <h3>注册新用户<span class="go">我有账号，去<a href="login.html" target="_blank">登陆</a></span></h3>
            <div class="info">
                <form class="sui-form form-horizontal">
                    <div class="control-group">
                        <label class="control-label">用户名：</label>
                        <div class="controls">
                            <input class="input-xfat input-xlarge" placeholder="请输入你的用户名" type="text"
                                   v-model="userEntity.username">
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">登录密码：</label>
                        <div class="controls">
                            <input class="input-xfat input-xlarge" placeholder="设置登录密码" type="password"
                                   v-model="userEntity.password">
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">确认密码：</label>
                        <div class="controls">
                            <input class="input-xfat input-xlarge" placeholder="再次确认密码" type="password"
                                   v-model="password2">
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label">手机号：</label>
                        <div class="controls">
                            <input class="input-xfat input-xlarge" placeholder="请输入你的手机号" type="text"
                                   v-model="userEntity.phone">
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">短信验证码：</label>
                        <div class="controls">
                            <input class="input-xfat input-xlarge" placeholder="短信验证码" type="text"
                                   v-model="userEntity.smscode">
                            <a @click="sendCode()" href="#">获取短信验证码</a>
                        </div>
                    </div>


                    <div class="control-group">
                        <label class="control-label"></label>
                        <div class="controls btn-reg">
                            <a @click="regist()"
                               class="sui-btn btn-block btn-xlarge btn-danger"
                               href="#"
                               target="_blank"
                            >完成注册</a>
                        </div>
                    </div>
                </form>
                <div class="clearfix"></div>
            </div>
        </div>

        <div class="py-container copyright">
            <ul class="helpLink">
                <li>关于我们<span class="space"></span></li>
                <li>联系我们<span class="space"></span></li>
                <li>联系客服<span class="space"></span></li>
                <li>合作招商<span class="space"></span></li>
                <li>商家帮助<span class="space"></span></li>
                <li>营销中心<span class="space"></span></li>
                <li>友情链接<span class="space"></span></li>
                <li>销售联盟<span class="space"></span></li>
                <li>友情链接<span class="space"></span></li>
                <li>隐私政策</li>
            </ul>
            <p>京公网安备 1****002000088号|京ICP证0*****9号|互联网药品信息服务资格证编号(京)-经营性-2014-0008 字第大1*****2号</p>
            <p>京ICP备0*****1号京公网安备1***********2</p>
        </div>
    </div>
</div>

<script src="plugins/jQuery/jquery-2.2.3.min.js" type="text/javascript"></script>
<script src="plugins/vue/vuejs-2.5.16.js" type="text/javascript"></script>
<script src="plugins/vue/axios-0.18.0.js" type="text/javascript"></script>
<script src="plugins/vue/qs.js" type="text/javascript"></script>

</body>

<script>
    new Vue({
        el: "#app",
        data: {
            userEntity: {
                username: '',
                password: '',
                phone: '',
                smscode: ''
            },
            password2: ''
        },
        methods: {
            sendCode: function () {
                if (this.userEntity.phone == null || this.userEntity.phone === "") {
                    alert("请填写手机号码");
                    return;
                }
                axios.get('/users/sendCode.do?phone=' + this.userEntity.phone)
                    .then(function (response) {
                        //获取服务端响应的结果
                        console.log(response.data);
                        alert(response.data.message);
                    }).catch(function (reason) {
                    console.log(reason);
                });
            },
            regist: function () {
                if (this.userEntity.phone == null || this.userEntity.phone == "") {
                    alert("请填写手机号码");
                    return;
                }
                //比较两次输入的密码是否一致
                if (this.userEntity.password != this.password2) {
                    alert("两次输入密码不一致，请重新输入");
                    this.userEntity.password = "";
                    this.password2 = "";
                    return;
                }

                axios.post('/user/add.do?smscode=' + this.userEntity.smscode, this.userEntity)
                    .then(function (response) {
                        //获取服务端响应的结果
                        console.log(response.data);
                        if (response.data.success) {
                            location.href = "login.html";
                        } else {
                            alert(response.data.message);
                        }
                    }).catch(function (reason) {
                    console.log(reason);
                });
            }
        },
        created: function () {

        }
    });
</script>

</html>